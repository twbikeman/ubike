<!DOCTYPE html>
<html lang="en" manifest="manifest.appcache">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">



    <script src="{{ url_for('static',filename='popper.min.js') }}"></script>
    <script src="{{ url_for('static',filename='bootstrap.min.js') }}"></script>
    <script src="{{ url_for('static',filename='d3.min.js') }}"></script>
    <link rel="stylesheet" href="{{ url_for('static',filename='bootstrap.min.css') }}">

    <!-- <style>

        rect {
            transition: all 0.3s;
        }

        rect:hover {
            fill: orange;
        }
    </style> -->

    <title>Document</title>
</head>
<body>
    <p>click on this text to update the chart with new data vlues(once)</p>
    <div id='num'>rent number: </div>
    <div id='barchart'></div>

    <script>

        var dataset = [];
        {% for value in data %}
        dataset.push({{ value }});
        {% endfor %}
        console.log(dataset);



        var w = 750, h = 500;

        svg = d3.select("#barchart")
            .append("svg")
            .attr("width", w)
            .attr("height", h);

        var yScale = d3.scaleLinear()
                        .domain([0, d3.max(dataset)])
                        .range([0,h]);
        
   

        var xScale = d3.scaleBand()
                        .domain(d3.range(dataset.length))
                        .rangeRound([0,w])
                        .padding(0.1);
        svg.selectAll("rect")
            .data(dataset)
            .enter()
            .append("rect")
            .attr("x", function(d, i){return xScale(i);})
            .attr("y", function(d){return h - yScale(d);})
            .attr("width", xScale.bandwidth())
            .attr("height", function(d){return yScale(d);})
            .attr("fill","red")
            .on("click",function(d){d3.select("#num").html(d)})
            .on("mouseover", function(d){d3.select(this).attr("fill","orange")})
            .on("mouseout", function(d){d3.select(this).attr("fill","red")});

        svg.selectAll("text")
            .data(dataset)
            .enter()
            .append("text")
            .text(function(d){return d;})

            .attr("font-family","sans-serif")
            .attr("font-size","11px")
            .attr("fill","white")
            .attr("text-anchor","middle")

            .attr("x", function(d, i){return xScale(i) + xScale.bandwidth() / 2 })
            .attr("y",function(d){return h - yScale(d) + 20;});
            
        // -----------transition----------
    
        // d3.select("p").on("click",function(){
        //     svg.selectAll("rect")
        //         .data(dataset1)
        //         .transition()
        //         .attr("x", function(d, i){return xScale(i);})
        //         .attr("y", function(d){return h - yScale(d);})
        //         .attr("width", xScale.bandwidth())
        //         .attr("height", function(d){return yScale(d);})
        //         .attr("fill","red");
        // });
            
    </script>
    
</body>
</html>